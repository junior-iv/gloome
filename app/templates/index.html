{% extends "base.html" %}

{% block title %}
{{ super() }}
{% endblock %}

{% block scripts %}
{{ super() }}
{% endblock %}

{% block menu %}
{{ super() }}
{% endblock %}

{% block header %}
{{ super() }}
{% endblock %}

{% block content %}
{{ super() }}
<script src="https://d3js.org/d3.v7.js"></script>
{#            <script src="https://d3js.org/d3.v4.js"></script>#}
<div class="gap-2 d-flex flex-column justify-content-center h-100 w-100">
    <div class="box gap-2 flex-row h-80 w-100">
        <div class="box gap-2 flex-column w-50 h-auto bg-light rounded-3 p-3 ms-3 me-1 my-3">
            <div class="container gap-2 flex-column d-flex h-70 w-95 bg-white align-content-center rounded-2">
                {{nwt.alerts(45)}}
                <div id="loader"></div>
                <div id="tree" class="m-0 p-0 h-auto w-auto"></div>
                <div id="tooltip" class="text-justify font-verdana"></div>
{#                <div class="tooltip" style="opacity: 0; font-size: 13px; left: 339px; top: 339px;"></div>#}
{#                    <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">В1</font></font>#}
{#                    <br>#}
{#                    <table class="w-97 p-4 tborder table-danger">#}
{#                    <tbody>#}
{#                        <tr><th class="p-2 h7 w-auto tborder-2 table-danger">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">Відстань:</font></font></th>#}
{#                        <th></th><td class="h7 w-auto text-center">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0,1</font></font></td>#}
{#                        </tr><tr><th class="p-2 h7 w-auto tborder-2 table-danger">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">Послідовність:</font></font></th>#}
{#                        <th></th><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td>#}
{#                        <td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td>#}
{#                        <td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td>#}
{#                        <td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td>#}
{#                        <td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                        <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td>#}
{#                        <td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                            <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td>#}
{#                        <td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light">#}
{#                            <font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td>#}
{#                        <td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">0</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td><td style="color: darkviolet" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">1</font></font></td></tr><tr><th class="p-2 h7 w-auto tborder-2 table-danger"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">Порівняння предків:</font></font></th><th></th><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: forestgreen" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">Г</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: darkorange" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">Л</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: forestgreen" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">Г</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: crimson" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">А</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td><td style="color: slateblue" class="h7 w-auto text-center tborder-1 table-danger bg-light"><font dir="auto" style="vertical-align: inherit;"><font dir="auto" style="vertical-align: inherit;">П</font></font></td></tr></tbody></table></div>#}
            </div>
            <div class="box gap-2 flex-row text-success h7">
                <div class="d-flex gap-2 w-60 flex-column">
                    <div class="text-center m-2 h6">Interactive Tree</div>
                    <ul class="zoomable-element">
                        <li>Hover over a node to view basic info</li>
                        <li>Click on a node to open a detailed table</li>
                        <li>Pinch with two fingers on a trackpad to zoom in/out</li>
                        <li>Drag with your mouse to move the tree</li>
                    </ul>
                </div>
                <div class="d-flex gap-2 w-40 flex-column">
                    <div class="text-center m-2 h6">Ancestral Comparison</div>
                    <ul class="zoomable-element">
                        <li>P = maintained presence;</li>
                        <li>A = maintained absence</li>
                        <li>L = loss</li>
                        <li>G = gain</li>
                    </ul>
                </div>
            </div>
            <div class="box gap-2 flex-row text-success h7">
                <div class="d-flex gap-2 w-60 flex-column">
                    <div class="gap-2 d-flex flex-row p-2 m-2 rounded-3 btn btn-outline-success bg-success-subtle">
                        <label for="showDistanceToParent" class="h6 container-checkbox">
                            <input value="1" id="showDistanceToParent" name="showDistanceToParent" onchange="reDrawPhylogeneticTree()"
                                   type="checkbox" class="container-checkbox-input"/>
                            <span class="container-checkbox-icon"></span>
                            <span class="container-checkbox-text">show distance to parent</span>
                        </label>
                    </div>
                </div>
                <div class="d-flex gap-2 w-40 flex-column">
                    <div class="gap-2 d-flex flex-row p-2 m-2 rounded-3 btn btn-outline-success bg-success-subtle">
                        <label for="isRadialTree" class="h6 container-checkbox">
                            <input value="1" id="isRadialTree" name="isRadialTree" onchange="reDrawPhylogeneticTree()"
                                   type="checkbox" class="container-checkbox-input"/>
                            <span class="container-checkbox-icon"></span>
                            <span class="container-checkbox-text">show radial tree</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div  class="box gap-2 flex-column w-50 h-auto bg-light rounded-3 p-3 me-3 ms-1 my-3">
            <div class="box gap-2 flex-column d-flex h-70 w-95 bg-white align-content-center rounded-2 p-3">
                <div class="text-center">
                    <label for="msaText" class="h6 text-success-emphasis align-content-center">Add a phyletic pattern MSA in FASTA format via text input or file upload
                        (<a href="https://en.wikipedia.org/wiki/FASTA_format" target="_blank">FASTA format</a>)<sup>&quest;</sup>
                    </label>
                </div>
                <div class="d-flex gap-2 flex-row justify-content-end">
                    <input id="msaTextFile" name="msaTextFile" type="file" accept="*.*"
                          class="form-control rounded-pill" onchange="uploadFile('msaText', 'msaTextFile')"/>
                </div>
                <textarea spellcheck="false" id="msaText" name="msaText" autocomplete="on" rows="auto" class="form-control btn-light font-verdana"
                          placeholder="please provide a phyletic MSA here"></textarea>
                <div class="text-center mt-1">
                    <label for="newickText" class="h6 text-success-emphasis align-content-center">Add a phylogenetic tree in Newick format via text input or file upload
                        (<a href="https://en.wikipedia.org/wiki/Newick_format" target="_blank">Newick format</a>)<sup>&quest;</sup>
                    </label>
                </div>
                <div class="d-flex gap-2 flex-row justify-content-end">
                    <input id="newickTextFile" name="newickTextFile" type="file" accept="*.*"
                           class="form-control rounded-pill" onchange="uploadFile('newickText', 'newickTextFile')"/>
                </div>
                <textarea spellcheck="false" id="newickText" name="newickText" autocomplete="on" rows="auto" class="form-control btn-light font-verdana"
                          placeholder="please provide a phylogenetic tree here"></textarea>
            </div>
            <div class="box gap-2 flex-row text-center w-100 justify-content-center">
                <div class="gap-2 d-flex w-50 flex-column m-2">
                    <input id="theExampleButton" name="theExampleButton" type="button" class="w-100 form-control btn btn-outline-success bg-success-subtle rounded-pill"
                           value="Load an example" onclick="loadExample(0)"/>
                </div>
                <div class="gap-2 d-flex w-50 flex-column m-2">
                    <input id="theСleaningButton" name="theСleaningButton" type="button" class="w-100 form-control btn btn-outline-success bg-success-subtle rounded-pill"
                           value="Clear" onclick="cleanForm()"/>
                </div>
            </div>
            <div class="d-flex gap-2 flex-column text-center w-100 px-2">
                <details>
                    <summary class="w-100 form-control btn btn-outline-success bg-success-subtle text-success border-0 rounded-pill">
                    Advanced Options
                    </summary>
                    <div class="box gap-2 w-100 flex-column">
                        <div class="box gap-2 flex-row h-auto w-100 m-2">
                            <div class="w-48 text-start">
                                <label for="pi1" class="h6 text-success-emphasis ms-3">π1</label>
                            </div>
                            <div class="w-48 text-start">
                                <input value="{{pi_1}}" id="pi1" name="pi1" type="number" min="0.001" max="0.999" step="0.001"
                                       title="The value must be between 0.001 and 0.999" onchange="validateInput('pi1', {{pi_1}})"
                                       class="form-control rounded-pill"/>
                            </div>
                        </div>
                        <div class="box gap-2 flex-row h-auto w-100 m-2">
                            <div class="w-48 text-start">
                                <label for="isOptimizePi" class="h6 text-start text-success-emphasis ms-3">optimize π1</label>
                            </div>
                            <div class="w-48 text-start">
                                <input value="1" id="isOptimizePi" name="isOptimizePi" onchange="setAccessibility('pi1')"
                                       type="checkbox" class="form-check-input rounded-1"/>
                            </div>
                        </div>
                        <div class="box gap-2 flex-row h-auto w-100 m-2">
                            <div class="w-48 text-start">
                                <label for="alpha" class="h6 text-start text-success-emphasis ms-3">alpha, beta</label>
                            </div>
                            <div class="w-48 text-start">
                                <input value="{{alpha}}" id="alpha" name="alpha" type="number" min="0.1" max="20" step="0.1"
                                       title="The value must be between 0.1 and 20" onchange="validateInput('alpha', {{alpha}})"
                                       class="form-control rounded-pill"/>
                            </div>
                        </div>
                        <div class="box gap-2 flex-row h-auto w-100 m-2">
                            <div class="w-48 text-start">
                                <label for="categoriesQuantity" class="h6 text-start text-success-emphasis ms-3">number of rate categories</label>
                            </div>
                            <div class="w-48 text-start">
                                <input value="{{categories_quantity}}" id="categoriesQuantity" name="categoriesQuantity"
                                       title="The value must be between 1 and 16" type="number" min="1" max="16" step="1"
                                       onchange="validateInput('categoriesQuantity', {{categories_quantity}})"
                                       class="form-control rounded-pill"/>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            <div class="d-flex gap-2 flex-row text-center w-100 justify-content-center mb-4 m-2">
                <input id="theButton" name="theButton" type="button" class="w-100 form-control btn btn-outline-success bg-success-subtle rounded-3"
                      value="SUBMIT" onclick="makeTree(0)"/>
            </div>
        </div>
    </div>
    <div class="box gap-2 flex-row w-100">
        <div id="result" class="d-flex gap-2 flex-column w-100 h-auto bg-light rounded-3 p-3 m-3 visually-hidden">
            <div id="logLikelihood" class="w-100 form-control btn btn-outline-success bg-success-subtle text-success border-0 rounded-pill">

            </div>
            <div id="fileList" class="d-flex gap-2 flex-column text-start w-100 px-2">

            </div>
            <div id="nodeInfo" class="d-flex gap-2 flex-column text-start w-100 px-2">

            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block messages %}
{{ super() }}
{% endblock %}
